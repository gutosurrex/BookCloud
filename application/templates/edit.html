{% extends "base_template.html" %}

{% block title %}{{ _('Edit: %(filename)s') | format(filename=filename) }} {% endblock%}

{% from "_sphinxuikit.html" import sphinx_uikit_script %}

{% block scripts %}
  {% assets "codemirror_css_all" %}
      <link rel="stylesheet" type="text/css" href="{{ ASSET_URL }}"></script>
  {% endassets %}

  {% assets "codemirror_js_all" %}
      <script type="text/javascript" src="{{ ASSET_URL }}" charset="utf-8"></script>
  {% endassets %}
  
  <style>

    .CodeMirror{
    height: calc(100vh - 100px);
    overflow: hidden;
    }
  </style>
  {{ sphinx_uikit_script() }}
{% endblock scripts %}

{% macro editor() %}
  <div id="header"
       style="height: 50px;">
    <div class="uk-inline uk-margin-small-top uk-margin-small-left">
      <button class="uk-button uk-button-small uk-background-default
                     uk-button-default" type="button">
        {{ _('sections') }}
      </button>
      <div uk-dropdown>
        <ul class="uk-nav uk-navbar-dropdown-nav" id="menu_insert_sections">
          <li>
            <button class="uk-button uk-button-text" data-type="cap">Cap
            </button>
          </li>
          <li>
            <button class="uk-button uk-button-text" data-type="sec">Sec
            </button>
          </li>
          <li>
            <button class="uk-button uk-button-text" data-type="sub">Sub
            </button>
          </li>
        </ul>
      </div>

      <button class="uk-button uk-button-small uk-background-default
                     uk-button-default" type="button">
        {{ _('style') }}
      </button>
      <div uk-dropdown>
        <ul class="uk-iconnav uk-iconnav-vertical" id="menu_insert_style">
          <li>
            <a data-insert-start="**" data-insert-end="**"
               title="{{ _('Bold') }}" uk-tooltip
               uk-icon="icon: bold"><b></b>
            </a>
          </li>
          <li>
            <a data-insert-start="*" data-insert-end="*"
               style="font-family:verdana;"
               title="{{ _('Italic') }}" uk-tooltip
               uk-icon="icon: italic"><i></i>
            </a>
          </li>
          <li>
            <a data-func="list" data-insert-start="* " data-insert-end=""
               title="{{ _('Itemize') }}" uk-tooltip
               uk-icon="icon: more-vertical">
            </a>
          </li>
          <li>
            <a data-func="list" data-insert-start="#. " data-insert-end="&#10;"
               title="{{ _('Enumerate') }}" uk-tooltip
               uk-icon="icon: list">
            </a>
          </li>
        </ul>
      </div>

      <button class="uk-button uk-button-small uk-background-default
              uk-button-default" type="button">
          {{ _('boxes') }}
      </button>
      <div uk-dropdown>
        <ul class="uk-nav uk-navbar-dropdown-nav" id="menu_insert_box">
          <li>
            <button class="uk-button uk-button-text insert-box-button"
               data-title="Para o professor"
                    title="{{ _('Para o professor') }}" uk-tooltip>{{ _('Para o professor') }}
            </button>
          </li>
          <li>
            <button class="uk-button uk-button-text insert-box-button"
                    data-title="Resposta"
                    title="{{ _('Resposta') }}" uk-tooltip>{{ _('Resposta') }}
            </button>
          </li>
          <li>
            <button class="uk-button uk-button-text insert-box-button"
                    data-title="Definição"
                    title="{{ _('Definição') }}" uk-tooltip>{{ _('Definição') }}
            </button>
          </li>
          <li>
            <button class="uk-button uk-button-text insert-box-button"
                    data-title="Teorema"
                    title="{{ _('Teorema') }}" uk-tooltip>{{ _('Teorema') }}
            </button>
          </li>
          <li>
            <button class="uk-button uk-button-text insert-box-button"
                    data-title="Exemplo"
                    title="{{ _('Exemplo') }}" uk-tooltip>{{ _('Exemplo') }}
            </button>
          </li>
          <li>
            <button class="uk-button uk-button-text insert-sec-button" data-type="ativ"
                    data-title="Atividade"
                    title="{{ _('Atividade') }}" uk-tooltip>{{ _('Atividade') }}
            </button>
          </li>
        </ul>
      </div>

      <button class="uk-button uk-button-small uk-background-default
              uk-button-default" type="button">
          {{ _('image') }}
      </button>
      <div uk-dropdown>
        <ul class="uk-iconnav uk-iconnav-vertical">
          <li>
            <a class="insert-image-button"
               title="{{ _('figure') }}" uk-tooltip
               uk-icon="icon: image">
              <font size="1"></font>
            </a>
          </li>
          <li>
            <a onclick="insertAround('.. table:: Legenda\n   :widths: 1 3\n   :column-alignment: left center\n\n   +---+---+\n   | A | B |\n   +===+===+\n   | 0 | 1 |\n   +---+---+\n   | 2 | 3 |\n   +---+---+\n','')"
               title="{{ _('Table') }}" uk-tooltip
               uk-icon="icon: thumbnails">
            </a>
          </li>
          <li>
            <a class="insert-around" data-insert-start="&#10;.. tikz:: legenda&#10;&#10;   \\draw (0,0)--(1,0)--(.5,.6)--(0,0);" data-insert-end=""
               title="{{ _('Tikz figure') }}" uk-tooltip
               uk-icon="icon: move">
            </a>
          </li>
        </ul>
      </div>

      <a class="uk-button uk-button-small uk-background-default
                uk-button-default insert-around" type="button"
         data-insert-start=":ref:`nome-da-referencia`" data-insert-end=""
         title="{{ _('Referência interna') }}" uk-tooltip
         uk-icon="icon: bookmark">
      </a>

      <button class="uk-button uk-button-small uk-background-default
              uk-button-default" type="button">
          {{ _('math') }}:
      </button>
      <div uk-dropdown>
        <div class="uk-flex uk-flex-wrap uk-flex-wrap-around
                    uk-background-default">
          <div>
            {{ _('Insert equation') }}
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small insert-around"
                    data-insert-start="`a = b`" data-insert-end=""
                    title="{{ _('Inline') }}" uk-tooltip>{{ _('Inline') }}
            </button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\n.. math::\n\n   a^2 = b','')"
                    title="{{ _('Displayed equation') }}" uk-tooltip>{{ _('Displayed equation') }}
            </button>
          </div>
        </div>
            {{ _('Math symbols') }}
          <div class="uk-flex uk-flex-wrap uk-flex-wrap-around
                      uk-background-default">
            <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\frac{1}{2}','')">&#xBD;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\sin(',')')">sin</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\cos(',')')">cos</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\neq','')">&#x2260;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\cap','')">&#x2229;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\cup','')">&#x222A;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\mathbb{R}','')">&#x211D;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\mathbb{Q}','')">&#x211A;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\mathbb{Z}','')">&#x2124;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\mathbb{N}','')">&#x2115;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\in','')">&#x2208;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\subset','')">&#x2282;</button>
          </div>
          <div>
            <button class="uk-button uk-button-default uk-button-small"
                    onclick="insertAround('\\overrightarrow{','}')">x&#8407;
          </button>
          </div>
        </div>
      </div>

      <a class="uk-button uk-button-small uk-background-default
                uk-button-default popitup" type="button"
                data-url="{{ url_for('html2rst') }}"
                title="{{ _('Visual writting tool') }}" uk-tooltip
                uk-icon="icon: pencil">
      </a>
              </div>
  </div>

  <div id="editor-wrap"
       style="height: calc(100vh - 50px);
              overflow: hidden;">
    <form id="myform" action="{{ url_for('branches.edit',
                              project=project.name, branch=branch.name,
                              filename=filename) }}" method="post">
      <textarea class="uk-textarea"
                id="code" name="code">{{ rst }}</textarea>


          <a href="{{ url_for('branches.view', project=project.name,
             branch=branch.name, filename=filename) }}"
             style="text-decoration:none">
            <input class="uk-button uk-button-primary uk-margin-left
                          uk-button-small
                          uk-margin-small-top"
                   type="button" value="exit"/>
          </a>

          <input class="uk-button uk-button-primary uk-margin-small-top
                        uk-button-small"
                 id="preview" name="preview" type="button"
                 value="save" />
          <input type="hidden" name="html_scroll" id="html_scroll"
                 value="{{ html_scroll }}" />
          <input type="hidden" name="edit_scroll" id="edit_scroll"
                 value="{{ edit_scroll }}" />

        </form>
</div>

{% endmacro%}

{% macro contents() %}{% endmacro %}

{% block document %}

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">

  {{ head() }}

  <div class="uk-flex uk-flex-stretch uk-background-muted">

    <div class="uk-width-1-2">
        {{ editor() }}
    </div>

    <div class="uk-width-1-2">
      <div style="height: 50px; overflow:hidden;">
        <a class="uk-button uk-button-default uk-button-small
           uk-margin-small-bottom uk-margin-small-left
           uk-margin-small-top"
           title="{{ _('Open menu bar') }}" uk-tooltip
           href="#modal-container" uk-toggle>Menu</a>
        <div id="modal-container" class="uk-modal-container" uk-modal>
          <div class="uk-modal-dialog uk-modal-body">
            <button class="uk-modal-close-default" type="button" uk-close>
            </button>
            {{ navigation_bar() }}
          </div>
        </div>
      </div>

      <div style="height: calc(100vh - 50px);
                  overflow: hidden;" id="html_view_holder">


      <div class="uk-card uk-card-default uk-card-body"
           id="html_view"
           style="height: calc(100vh - 100px);
                  top: 0px;
                  overflow-y: scroll;"
           onload="document.getElementById('html_view').scrollTop = 200;">

        {{ flash_messages() }}

          {{ doc | safe }}
      </div>
    </div>
  </div>
  
  <div id="sections_modal" uk-modal>
      <div class="uk-modal-dialog uk-modal-body">
          <h2 class="uk-modal-title">Inserir seção.</h2>
          <input id="insert_section_title" class="uk-input" type="text" name="title" value="" placeholder="Título">
          <p class="uk-text-right">
              <button class="uk-button uk-button-default uk-modal-close" type="button">Cancelar</button>
              <button class="uk-button uk-button-primary" type="button" id="insert_section_button">Inserir</button>
          </p>
      </div>
  </div>
  
  <div id="boxes_modal" uk-modal>
      <div class="uk-modal-dialog uk-modal-body">
          <h2 class="uk-modal-title">Inserir box.</h2>
          <textarea id="insert_box_text" class="uk-textarea" type="text" name="text" placeholder="Texto" rows="8"></textarea>
          <p class="uk-text-right">
              <button class="uk-button uk-button-default uk-modal-close" type="button">Cancelar</button>
              <button class="uk-button uk-button-primary" type="button" id="insert_box_button">Inserir</button>
          </p>
      </div>
  </div>
  
  <div id="insert_image_modal" uk-modal>
    <div class="uk-modal-dialog">
        <button class="uk-modal-close-default" type="button" uk-close></button>
        <div class="uk-modal-header">
            <h2 class="uk-modal-title">Inserir imagem</h2>
        </div>
        <div class="uk-modal-body">
          <div uk-form-custom="target: true">
              <input type="file">
              <input class="uk-input uk-form-width-medium" type="text" placeholder="Select file" disabled>
          </div>
        </div>
        <div class="uk-modal-footer uk-text-right">
            <button class="uk-button uk-button-default uk-modal-close" type="button">Cancelar</button>
            <button class="uk-button uk-button-primary" type="button">Inserir</button>
        </div>
    </div>
</div>

</html>
{% endblock %}
