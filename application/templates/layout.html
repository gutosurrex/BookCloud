{% macro flash() %}
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<ui class="flashes">
  {% for category, message in messages %}
  <li class="{{ category }}">{{ message }}</li>
  {% endfor %}
</ui>
{% endif %}
{% endwith %}
{% endmacro %}

{% if barebones %}

<div class="document">
  <div class="body" role="main">
    {{ flash() | safe }}
    {{ contents() | safe }}
  </div>
  <div class="clearer"></div>
</div>

{% else %}

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>{% block title %}{% endblock %}</title>

    <link rel="stylesheet" href="{{ url_for('.get_global_static', filename='bizstyle.css') }}" type="text/css" />
    <link rel="stylesheet" href="{{ url_for('.get_global_static', filename='cloud.css') }}" type="text/css" />

    <!--<link rel="stylesheet" href="/_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="/_static/pygments.css" type="text/css" />-->

    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script src="//cdn.jsdelivr.net/jdenticon/1.3.2/jdenticon.min.js" async></script>

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    './',
      VERSION:     '',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
      };
    </script>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <!--
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    -->

    <script>
      $(document).ready(function() {
        $("a[href^='http']").attr('target','_blank');
      });
    </script>


    <link rel="top" title="Livro Aberto de Matematica" href="#" />

    {% block scripts %}{% endblock %}

    <style>
      ol li p {
        display: inline;
      }

      .info {
        padding: 20px;
        background-color: #1abc9c;
        color: white;
        margin-bottom: 15px;
      }

      .error {
        padding: 20px;
        background-color: #ea9b92;
        color: white;
        margin-bottom: 15px;
      }

      .attention{
        background-color: #ea9b92;
      }

      .comment {
      padding-left: 15px;
      padding-bottom: 7px;
      padding-top: 12px;
      border-left: solid #d5e3f1 16px;
      border-bottom: solid #d5e3f1 1px;
      }

      .thread {
      top: 30px;
      }

      .thread-head {
      background-color: #d5e3f1;
      padding-left: 22px;
      padding-bottom: 10px;
      padding-top: 7px;
      }

      .comment-content {
      padding:5px;
      }
    </style>

  </head>

  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      {% block bar %}
      <ul>
        {% if menu %}
          {% for t in menu.left %}
          <li class="left" style="margin-right: 10px">
            <a href="{{ t.url }}">{{ t.name }}</a>
          </li>
          {% endfor %}

          {% for t in menu.right %}
          <li class="right" style="margin-right: 10px">
            <a href="{{ t.url }}"
               {%- if t.style == 'attention' %}
               class="attention"
               {%- endif %}>{{ t.name }}</a>
          </li>
          {% endfor %}
          {% if threads %}
            <li>
              || <a href="#discussion">{{ _('discussion') }} ({{ threads | length }}) </a>
            </li>
          {% endif %}

          <li class="right" style="margin-right: 10px">
            <a href="https://github.com/gutosurrex/BookCloud/issues" target="_blank">issues</a>
            <a href="https://www.umlivroaberto.com/BookCloud/sintaxe/master/view/index.html" target="_blank">syntax</a>
            <a href="https://www.umlivroaberto.com/wiki/" target="_blank">staff</a>
            ||
          </li>



        {% endif %}
      </ul>
      {% endblock %}
    </div>

    {% block sidebar %}{% endblock %}

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">

            {{ flash() | safe }}
            {{ contents() | safe }}

            {% if threads %}
              <h2 id="discussion">Discussions</h2>
              {% for t in threads %}
                <div class="thread">
                  <div class="thread-head" style="padding: 10px;">
                    <div style="display: table-row">
                      <div style="display: table-cell;">
                        <canvas width="40" height="40" data-jdenticon-hash="{{ hash(t.author) }}"
                                style="vertical-align: baseline;"></canvas>
                      </div>
                      <div style="display: table-cell; vertical-align: top; padding-left: 10px;">
                        {{ t.author }} ({{ t.flag }}) - {{ t.posted_at }}:
                        <br>
                          <b style="color: #336699; font-size: 1.2em;"> {{ t.title }} </b> 
                          ({{ t.number }} {{ _('comments') }})
                      </div>
                    </div>
                    <p>
                      {{ _('Users:') }} {% for user in t.user_tags %}{{ user }}{% endfor %} |
                      {{ _('Files:') }} {% for file in t.file_tags %}{{ file }}{% endfor %} |
                      {{ _('Tags:') }} {% for custom in t.custom_tags %}{{ custom }}{% endfor %} |
                      {{ _('Free:') }} {% for free in t.free_tags %}{{ free }}{% endfor %} |
                    </p>
                  </div>
                </div>
                {% for c in t.comments %}
                  <div class="comment" class="table-row" style="margin-left: {{ c.indent }}px;">
                    <div style="display: table-cell;">
                      <canvas width="40" height="40" data-jdenticon-hash="{{ hash(c.author) }}"></canvas>
                    </div>
                    <div style="display: table-cell; vertical-align: top; padding-left: 10px;">
                      {{ c.author }} - {{ c.posted_at }},
                      <br>
                      <b style="color: #336699; font-size: 1em;"> {{ c.title }} </b>
                      ({{ c.likes }} {{ _('likes') }})
                    </div>
                    <div class="comment-content">
                      {{ c.content | safe }}
                    </div>
                  </div>
                {% endfor %}
          </div>
        {% endfor %}
      {% endif %}

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      {{ self.bar() | safe }}
    </div>

    <div class="footer" role="contentinfo">
      &copy; {{ copyright }}.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>
{% endif %}
